%html
  %head
    %title Scotland's Covid-19 Figures
    %link{rel: 'stylesheet', href:'index.css'}
  %body
    %h1 Scotland's Covid-19 Figures
    %p
      This site hastily throuwn together by
      %a{href: 'https://twitter.com/robertgauld'}@RobertGauld
      What started as an exploration of the data and then learning gnuplot led to this, the code
      isn't pretty but will at some point find it's way onto my Github.
    %p
      Thanks to
      %a{href: 'https://github.com/watty62'} watty62
      for collecting and preprocessing the Scotland data at
      %a{href: 'https://github.com/watty62/Scot_covid19'} https://github.com/watty62/Scot_covid19
      Data upto #{upto_scotland.strftime('%A %-d %B %Y')} is currently available and displayed.
      %br
      Thanks to
      %a{href: 'https://github.com/tomwhite'} tomwhite
      for collecting and preprocessing the UK data at
      %a{href: 'https://github.com/tomwhite/covid-19-uk-data'} https://github.com/tomwhite/covid-19-uk-data
      Data upto #{upto_uk.strftime('%A %-d %B %Y')} is currently available and displayed.
      - if updating
        %span.highlight
          The data is currently being updated.
    %p
      On start up and every hour thereafter this site checks for new data and if 
      new data is available it regenerates itself.
      - if updating
        %span.highlight
          The data is currently being updated.
      Two of the graphs below are absent as the corresponding health boards (Orkney and Western Isles)
      have reported zero cases. When they report a case then the graphs will be automatically generated.

    #links{style: 'padding-left: 15%; padding-right: 15%;'}
      %div{style: 'display: inline-block; min-width: 16em;'}
        %a{style: 'margin-left: 17.2em; margin-right: 1em;', href: '#scotland'} Scotland
      %br
      %br
      - health_boards.each do |health_board|
        - health_board_link = health_board.downcase.gsub(' ', '_')
        %div{style: 'display: inline-block; min-width: 16em;'}
          %a{style: 'margin-left: 1em; margin-right: 1em;', href: "##{health_board_link}"}=health_board

    %a{name: 'scotland'}
    %h2 Whole of Scotland
    #scotland
      .chart
        %a{href: '/daily_tests.png'}
          %img{src: '/daily_tests.png', width: 450, height: 300}
        %br
        %a{href: '/tests.csv'} Download data
      .chart
        %a{href: '/cumulative_tests.png'}
          %img{src: '/cumulative_tests.png', width: 450, height: 300}
        %br
        %a{href: '/tests.csv'} Download data
      .chart
        %a{href: "/cases_per_#{numbers_per}.png"}
          %img{src: "/cases_per_#{numbers_per}.png", width: 450, height: 300}
        %br
        %a{href: "/cases_per_#{numbers_per}.csv"} Download data
      .chart
        %a{href: "/deaths_per_#{numbers_per}.png"}
          %img{src: "/deaths_per_#{numbers_per}.png", width: 450, height: 300}
        %br
        %a{href: "/deaths_per_#{numbers_per}.csv"} Download data
      .chart
        %a{href: '/icu_deceased.png'}
          %img{src: '/icu_deceased.png', width: 450, height: 300}
        %br
        %a{href: '/icu_deceased.csv'} Download data
      .chart
        %a{href: '/scotland_vs_uk.png'}
          %img{src: '/scotland_vs_uk.png', width: 450, height: 300}
        %br
        %a{href: '/scotland_vs_uk.csv'} Download data

    %hr{width: '50%', style: 'margin-top: 3em;'}

    - health_boards.each do |health_board|
      - health_board_link = health_board.downcase.gsub(' ', '_')
      %a{name: health_board_link}
      %h2=health_board
      %a{href: "/#{health_board_link}_per_#{numbers_per}.csv"} Download data
      #scotland{class: 'health_board_link'}
        .chart
          %a{href: "/#{health_board_link}_per_#{numbers_per}.png"}
            %img{src: "/#{health_board_link}_per_#{numbers_per}.png", width: 450, height: 300}
        .chart
          %a{href: "/#{health_board_link}_vs_scotland.png"}
            %img{src: "/#{health_board_link}_vs_scotland.png", width: 450, height: 300}

    %hr{width: '50%', style: 'margin-top: 3em;'}
